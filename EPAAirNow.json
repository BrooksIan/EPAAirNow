{"paragraphs":[{"text":"%md\n\n## Data Science In Apache Spark\n### EPA Air Now\n#### Exploring EPA Air Now Data \n\n**Language**: Scala\n**Requirements**: \n- [HDP 2.6.X]\n- Spark 2.x\n\n**Author**: Ian Brooks\n\n**Follow**: [LinkedIn Ian Brooks PhD](https://www.linkedin.com/in/ianrbrooksphd/)\n\n**Source Data**: [EPA Air Now Search Site](https://aqs.epa.gov/api)\n\n**Date Format**: [Oracle Date Format](https://docs.oracle.com/javase/tutorial/i18n/format/simpleDateFormat.html)\n\n**File Upload:**: Upload the source data json  files to HDFS in the /tmp directory\n\n![AirNow](http://www.sonomatech.com/sites/default/files/Plain_large_T.png \"EPA Air Now\")","user":"admin","dateUpdated":"2018-12-07T13:35:30-0800","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1544216018585_1988173282","id":"20181101-134841_1602903440","dateCreated":"2018-12-07T12:53:38-0800","dateStarted":"2018-12-07T13:35:30-0800","dateFinished":"2018-12-07T13:35:30-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:14360"},{"title":"Load Dependency Library ","text":"%spark2.dep \n\nz.load(\"com.databricks:spark-csv_2.11:1.5.0\")\n","user":"admin","dateUpdated":"2018-12-07T13:21:12-0800","config":{"editorSetting":{"language":"scala","editOnDblClick":false},"colWidth":12,"editorMode":"ace/mode/scala","editorHide":true,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1544216018590_1987788533","id":"20181101-135228_262536942","dateCreated":"2018-12-07T12:53:38-0800","dateStarted":"2018-12-07T13:21:12-0800","dateFinished":"2018-12-07T13:21:23-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:14361"},{"title":"Download Data Files and Copy To HDFS","text":"%sh\n\n#Enable SH Zeppelin interpreter\n\n# Download Data from Github\nwget https://raw.githubusercontent.com/BrooksIan/EPAAirNow/master/AQDM_358425767.txt -O /tmp/AQDM_358425767.txt\n\n# Make HDFS Directory and Load CSV files into HDFS\nhadoop fs -mkdir /tmp/\nhadoop fs -put /tmp/AQDM_358425767.txt /tmp/AQDM_358425767.txt\n\nhadoop fs -ls /tmp/AQDM*\n","dateUpdated":"2018-12-07T13:03:54-0800","config":{"editorSetting":{"language":"sh","editOnDblClick":false},"colWidth":12,"editorMode":"ace/mode/sh","editorHide":false,"title":true,"results":{},"enabled":false},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1544216018591_1987403784","id":"20181130-081036_1002586778","dateCreated":"2018-12-07T12:53:38-0800","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:14362"},{"title":"Initialize Spark Session","text":"%spark2\n\nimport org.apache.spark.sql.SparkSession\nval spark: SparkSession = SparkSession.builder\n  .appName(\"SBIR\")  // optional and will be autogenerated if not specified\n  .master(\"local[*]\")               // avoid hardcoding the deployment environment\n  .enableHiveSupport()              // self-explanatory, isn't it?\n  .config(\"spark.sql.warehouse.dir\", \"target/spark-warehouse\")\n  .getOrCreate\n\nspark.version\n","user":"admin","dateUpdated":"2018-12-07T13:21:20-0800","config":{"editorSetting":{"language":"scala","editOnDblClick":false},"colWidth":12,"editorMode":"ace/mode/scala","title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1544216018592_1973168075","id":"20181101-135113_950238278","dateCreated":"2018-12-07T12:53:38-0800","dateStarted":"2018-12-07T13:21:20-0800","dateFinished":"2018-12-07T13:21:46-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:14363"},{"title":"Load Data File, Build Dataframe, and Create Table View","text":"%spark2\n\nimport org.apache.spark.sql.types._\nimport org.apache.spark.sql.DataFrame\nimport scala.collection.mutable.ListBuffer\n\n//Create a data frame from CSV File \nval df_WholeSetRaw = sqlContext.read.format(\"com.databricks.spark.csv\").option(\"header\", \"true\").option(\"inferSchema\", \"true\").load(\"/tmp/AQDM_358425767.txt\")\n\n//df_WholeSetRaw.cache()\n\n//Create Table from DataFrame\n//df_WholeSetRaw.createOrReplaceTempView(\"EPAAIRNOW\")\n\n//Display resulting Infered schema \ndf_WholeSetRaw.printSchema()","user":"admin","dateUpdated":"2018-12-07T13:21:39-0800","config":{"editorSetting":{"language":"scala"},"colWidth":12,"editorMode":"ace/mode/scala","title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1544216018594_1973937573","id":"20181101-135144_252459906","dateCreated":"2018-12-07T12:53:38-0800","dateStarted":"2018-12-07T13:21:39-0800","dateFinished":"2018-12-07T13:22:07-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:14364"},{"title":"Manage Timestamp","text":"%spark2\n\nimport org.apache.spark.sql.functions.{to_date, to_timestamp}\n\nval modifiedDF = df_WholeSetRaw.withColumn(\"DateSub\", expr(\"substring(datetime, 1, length(datetime)-5)\") )\n\n\nval modifiedDF1 = modifiedDF.withColumn(\"timestamp\", unix_timestamp($\"DateSub\", \"yyyymmdd'T'kkmm\").cast(TimestampType))\n\nmodifiedDF1.cache()\nmodifiedDF1.printSchema()\nmodifiedDF1.take(1)\n\nmodifiedDF1.createOrReplaceTempView(\"EPAAIRNOW\")\n","user":"admin","dateUpdated":"2018-12-07T13:35:01-0800","config":{"editorSetting":{"language":"scala"},"colWidth":12,"editorMode":"ace/mode/scala","title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1544216018595_1973552824","id":"20181207-102416_649987066","dateCreated":"2018-12-07T12:53:38-0800","dateStarted":"2018-12-07T13:21:46-0800","dateFinished":"2018-12-07T13:22:14-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:14365"},{"title":"Query Raw Table","text":"%spark2.sql\n\nselect * from EPAAIRNOW limit 100\n","user":"admin","dateUpdated":"2018-12-07T13:34:42-0800","config":{"editorSetting":{"language":"sql","editOnDblClick":false},"colWidth":12,"editorMode":"ace/mode/sql","title":true,"results":{},"enabled":true,"editorHide":false},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1544216018596_1971629079","id":"20181101-135753_1679218347","dateCreated":"2018-12-07T12:53:38-0800","dateStarted":"2018-12-07T13:22:08-0800","dateFinished":"2018-12-07T13:22:15-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:14366"},{"title":"Prepare Site Locations Information","text":"%spark2.sql\n\nselect distinct site, lat, lon from EPAAIRNOW order by site limit 100 ","user":"admin","dateUpdated":"2018-12-07T13:34:38-0800","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"sql"},"editorMode":"ace/mode/sql","title":true,"editorHide":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1544216877835_1083085694","id":"20181207-130757_112947784","dateCreated":"2018-12-07T13:07:57-0800","dateStarted":"2018-12-07T13:27:30-0800","dateFinished":"2018-12-07T13:27:31-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:14367"},{"title":"Build Dataframe for Site Locations and Save to Zeppelin Backend","text":"%spark2\n\nval siteDF = spark.sql(\"select distinct lat, lon, site from EPAAIRNOW\")\n\nsiteDF.cache()\nsiteDF.take(20)\nsiteDF.count()\n\nz.angularBind(\"SiteLocations1\", siteDF.take(30))","user":"admin","dateUpdated":"2018-12-07T13:31:36-0800","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false},"editorMode":"ace/mode/scala","title":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1544216779886_1026958327","id":"20181207-130619_514175184","dateCreated":"2018-12-07T13:06:19-0800","dateStarted":"2018-12-07T13:31:36-0800","dateFinished":"2018-12-07T13:31:39-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:14368"},{"title":"Display Locations","text":"%angular\n\n<link rel=\"stylesheet\" href=\"https://cdnjs.cloudflare.com/ajax/libs/leaflet/0.7.5/leaflet.css\" />\n<div id=\"map\" style=\"height: 500px; width: 100%\"></div>\n\n<script type=\"text/javascript\">\nfunction initMap() { \t\t\n    var map = L.map('map').setView([31.150, -104.810], 6);\n    L.tileLayer('http://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png').addTo(map);\n    var geoMarkers = L.layerGroup().addTo(map);\n    \n    var RedIcon = L.icon({\n    iconUrl: 'https://mt.googleapis.com/vt/icon/name=icons/onion/123-red-dot.png',\n    iconSize: [32, 32],\n    });\n    \n    var BlueIcon = L.icon({\n    iconUrl: 'https://mt.googleapis.com/vt/icon/name=icons/onion/22-blue-dot.png',\n    iconSize: [32, 32],\n    });\n    \n    var el = angular.element($('#map').parent('.ng-scope'));\n    angular.element(el).ready(function() {\n        window.locationWatcher = el.scope().compiledScope.$watch('SiteLocations1', function(newValue, oldValue) {\n            geoMarkers.clearLayers();\n            angular.forEach(newValue, function(event) {\n                if (event){\n                    var marker = L.marker([event.values[0], event.values[1]], {icon: BlueIcon}).bindPopup(\"Site: \" + event.values[2]).addTo(geoMarkers);\n                }\n            });\n        })\n    });\n    \n}\n\nif (window.locationWatcher) { window.locationWatcher(); }\n\n// ensure we only load the script once, seems to cause issues otherwise\nif (window.L) {\n    initMap();\n} else {\n    console.log('Loading Leaflet library');\n    var sc = document.createElement('script');\n    sc.type = 'text/javascript';\n    sc.src = 'https://cdnjs.cloudflare.com/ajax/libs/leaflet/0.7.5/leaflet.js';\n    sc.onload = initMap;\n    sc.onerror = function(err) { alert(err); }\n    document.getElementsByTagName('head')[0].appendChild(sc);\n}\n</script>","user":"admin","dateUpdated":"2018-12-07T13:33:11-0800","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"text","editOnDblClick":true},"editorMode":"ace/mode/undefined","editorHide":true,"tableHide":false,"title":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1544216749680_451527214","id":"20181207-130549_1976140402","dateCreated":"2018-12-07T13:05:49-0800","dateStarted":"2018-12-07T13:33:11-0800","dateFinished":"2018-12-07T13:33:11-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:14369"},{"title":"Records By Site","text":"%sql\n\nselect site, count(site) from EPAAIRNOW group by site\n","user":"admin","dateUpdated":"2018-12-07T13:33:51-0800","config":{"editorSetting":{"language":"sql","editOnDblClick":false},"colWidth":4,"editorMode":"ace/mode/sql","editorHide":true,"title":true,"results":{"0":{"graph":{"mode":"multiBarChart","height":285.994,"optionOpen":false},"helium":{}}},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1544216018597_1971244330","id":"20181101-141125_1067785878","dateCreated":"2018-12-07T12:53:38-0800","dateStarted":"2018-12-07T13:25:10-0800","dateFinished":"2018-12-07T13:25:12-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:14370"},{"title":"Records By Action Code","text":"%sql\n\nselect action_code, count(action_code) from EPAAIRNOW group by action_code\n","user":"admin","dateUpdated":"2018-12-07T13:33:39-0800","config":{"editorSetting":{"language":"sql","editOnDblClick":false},"colWidth":4,"editorMode":"ace/mode/sql","editorHide":true,"title":true,"results":{"0":{"graph":{"mode":"pieChart","height":291.974,"optionOpen":false,"setting":{"pieChart":{}},"commonSetting":{},"keys":[{"name":"action_code","index":0,"aggr":"sum"}],"groups":[],"values":[{"name":"count(action_code)","index":1,"aggr":"sum"}]},"helium":{}},"1":{"graph":{"mode":"table","height":300,"optionOpen":false}}},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1544216018599_1972013828","id":"20181101-141412_707088412","dateCreated":"2018-12-07T12:53:38-0800","dateStarted":"2018-12-07T13:25:11-0800","dateFinished":"2018-12-07T13:25:14-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:14371"},{"title":"Records By Method Code","text":"%sql\n\nselect method_code, count(method_code) from EPAAIRNOW group by method_code\n","user":"admin","dateUpdated":"2018-12-07T13:33:40-0800","config":{"editorSetting":{"language":"sql","editOnDblClick":false},"colWidth":4,"editorMode":"ace/mode/sql","editorHide":true,"title":true,"results":{"0":{"graph":{"mode":"pieChart","height":291.974,"optionOpen":false,"setting":{"pieChart":{}},"commonSetting":{},"keys":[{"name":"method_code","index":0,"aggr":"sum"}],"groups":[],"values":[{"name":"count(method_code)","index":1,"aggr":"sum"}]},"helium":{}},"1":{"graph":{"mode":"table","height":300,"optionOpen":false}}},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1544216018601_1969705335","id":"20181207-110347_717832730","dateCreated":"2018-12-07T12:53:38-0800","dateStarted":"2018-12-07T13:25:21-0800","dateFinished":"2018-12-07T13:25:23-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:14372"},{"title":"Records By GISDatum ","text":"%sql\n\nselect GISDatum, count(GISDatum) from EPAAIRNOW group by GISDatum\n","user":"admin","dateUpdated":"2018-12-07T13:33:43-0800","config":{"editorSetting":{"language":"sql","editOnDblClick":false},"colWidth":4,"editorMode":"ace/mode/sql","editorHide":true,"title":true,"results":{"0":{"graph":{"mode":"pieChart","height":291.974,"optionOpen":false,"setting":{"pieChart":{}},"commonSetting":{},"keys":[{"name":"GISDatum","index":0,"aggr":"sum"}],"groups":[],"values":[{"name":"count(GISDatum)","index":1,"aggr":"sum"}]},"helium":{}},"1":{"graph":{"mode":"table","height":300,"optionOpen":false}}},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1544216018600_1970090084","id":"20181207-105644_1717288977","dateCreated":"2018-12-07T12:53:38-0800","dateStarted":"2018-12-07T13:25:12-0800","dateFinished":"2018-12-07T13:25:15-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:14373"},{"title":"Records By Parameter Code","text":"%sql\n\nselect parameter, count(parameter) from EPAAIRNOW group by parameter\n","user":"admin","dateUpdated":"2018-12-07T13:33:44-0800","config":{"editorSetting":{"language":"sql","editOnDblClick":false},"colWidth":4,"editorMode":"ace/mode/sql","editorHide":true,"title":true,"results":{"0":{"graph":{"mode":"pieChart","height":291.974,"optionOpen":false,"setting":{"pieChart":{}},"commonSetting":{},"keys":[{"name":"parameter","index":0,"aggr":"sum"}],"groups":[],"values":[{"name":"count(parameter)","index":1,"aggr":"sum"}]},"helium":{}},"1":{"graph":{"mode":"table","height":300,"optionOpen":false}}},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1544216018602_1970859581","id":"20181207-110424_809414785","dateCreated":"2018-12-07T12:53:38-0800","dateStarted":"2018-12-07T13:25:23-0800","dateFinished":"2018-12-07T13:25:25-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:14374"},{"title":"Records By Ele","text":"%sql\n\nselect elev, count(elev) from EPAAIRNOW group by elev\n","user":"admin","dateUpdated":"2018-12-07T13:33:55-0800","config":{"editorSetting":{"language":"sql","editOnDblClick":false},"colWidth":4,"editorMode":"ace/mode/sql","editorHide":true,"title":true,"results":{"0":{"graph":{"mode":"multiBarChart","height":291.974,"optionOpen":false,"setting":{"pieChart":{}},"commonSetting":{},"keys":[{"name":"elev","index":0,"aggr":"sum"}],"groups":[],"values":[{"name":"count(elev)","index":1,"aggr":"sum"}]},"helium":{}},"1":{"graph":{"mode":"table","height":300,"optionOpen":false}}},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1544216018603_1970474832","id":"20181207-110717_1022089094","dateCreated":"2018-12-07T12:53:38-0800","dateStarted":"2018-12-07T13:25:18-0800","dateFinished":"2018-12-07T13:25:20-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:14375"},{"title":"AirQuality Value From Sites By Timestamp","text":"%sql\n\nselect timestamp, value, site from EPAAIRNOW where value > 0 group by timestamp, value, site limit 1000\n","user":"admin","dateUpdated":"2018-12-07T13:34:00-0800","config":{"editorSetting":{"language":"sql","editOnDblClick":false},"colWidth":12,"editorMode":"ace/mode/sql","editorHide":true,"title":true,"results":{"0":{"graph":{"mode":"lineChart","height":384,"optionOpen":false,"setting":{"pieChart":{},"scatterChart":{"xAxis":{"name":"timestamp","index":0,"aggr":"sum"},"yAxis":{"name":"value","index":2,"aggr":"sum"}},"lineChart":{}},"keys":[{"name":"timestamp","index":0,"aggr":"sum"}],"groups":[{"name":"site","index":2,"aggr":"sum"}],"values":[{"name":"value","index":1,"aggr":"max"}],"commonSetting":{}},"helium":{}},"1":{"graph":{"mode":"table","height":300,"optionOpen":false}}},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1544216018604_1968551088","id":"20181101-141514_1152598520","dateCreated":"2018-12-07T12:53:38-0800","dateStarted":"2018-12-07T13:26:03-0800","dateFinished":"2018-12-07T13:26:04-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:14376"},{"title":"AirQuality Value Min, Max, & Avg From All Sites By Date","text":"%sql\n\nselect dayofyear(timestamp), avg(value), min(value), max(value) from EPAAIRNOW group by timestamp, value limit 1000\n","user":"admin","dateUpdated":"2018-12-07T13:34:03-0800","config":{"editorSetting":{"language":"sql"},"colWidth":12,"editorMode":"ace/mode/sql","title":true,"results":{"0":{"graph":{"mode":"lineChart","height":300,"optionOpen":false,"setting":{"lineChart":{}},"commonSetting":{},"keys":[{"name":"dayofyear(CAST(timestamp AS DATE))","index":0,"aggr":"sum"}],"groups":[],"values":[{"name":"avg(value)","index":1,"aggr":"avg"},{"name":"min(value)","index":2,"aggr":"min"},{"name":"max(value)","index":3,"aggr":"max"}]},"helium":{}}},"enabled":true,"editorHide":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1544216018606_1969320586","id":"20181207-112443_125366151","dateCreated":"2018-12-07T12:53:38-0800","dateStarted":"2018-12-07T13:26:05-0800","dateFinished":"2018-12-07T13:26:06-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:14377"},{"title":"Air Quality Value Date: Jan 5 2018 From All Sites","text":"%sql\n\nselect timestamp, value, site from EPAAIRNOW where dayofyear(timestamp) = 5 and value > 10 group by timestamp, value, site limit 1000","user":"admin","dateUpdated":"2018-12-07T13:34:07-0800","config":{"editorSetting":{"language":"sql"},"colWidth":12,"editorMode":"ace/mode/sql","title":true,"results":{"0":{"graph":{"mode":"lineChart","height":300,"optionOpen":false,"setting":{"lineChart":{}},"commonSetting":{},"keys":[{"name":"timestamp","index":0,"aggr":"sum"}],"groups":[{"name":"site","index":2,"aggr":"sum"}],"values":[{"name":"value","index":1,"aggr":"avg"}]},"helium":{}}},"enabled":true,"editorHide":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1544216018608_1979324057","id":"20181207-113931_999186323","dateCreated":"2018-12-07T12:53:38-0800","dateStarted":"2018-12-07T13:26:15-0800","dateFinished":"2018-12-07T13:26:17-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:14378"},{"title":"AirQuality Value By Timestamp From Two Sites","text":"%sql\n\nselect timestamp, value, site from EPAAIRNOW where site = 840480430101 or site = 840482450101 group by timestamp, value, site limit 1000\n","user":"admin","dateUpdated":"2018-12-07T13:34:11-0800","config":{"editorSetting":{"language":"sql","editOnDblClick":false},"colWidth":12,"editorMode":"ace/mode/sql","editorHide":true,"title":true,"results":{"0":{"graph":{"mode":"lineChart","height":384,"optionOpen":false,"setting":{"pieChart":{},"scatterChart":{"xAxis":{"name":"timestamp","index":0,"aggr":"sum"},"yAxis":{"name":"value","index":2,"aggr":"sum"}},"lineChart":{}},"keys":[{"name":"timestamp","index":0,"aggr":"sum"}],"groups":[{"name":"site","index":2,"aggr":"sum"}],"values":[{"name":"value","index":1,"aggr":"max"}],"commonSetting":{}},"helium":{}},"1":{"graph":{"mode":"table","height":300,"optionOpen":false}}},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1544216018611_1979708806","id":"20181207-111803_1783305135","dateCreated":"2018-12-07T12:53:38-0800","dateStarted":"2018-12-07T13:26:26-0800","dateFinished":"2018-12-07T13:26:27-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:14379"},{"title":"MPC Values (Min, Max, Avg) By Timestamp From All Sites","text":"%sql\n\nselect timestamp, site, mpc_value from EPAAIRNOW group by timestamp, mpc_value, site limit 1000 \n","user":"admin","dateUpdated":"2018-12-07T13:34:13-0800","config":{"editorSetting":{"language":"sql","editOnDblClick":false},"colWidth":12,"editorMode":"ace/mode/sql","editorHide":true,"title":true,"results":{"0":{"graph":{"mode":"lineChart","height":384,"optionOpen":false,"setting":{"pieChart":{},"scatterChart":{"xAxis":{"name":"timestamp","index":0,"aggr":"sum"},"yAxis":{"name":"value","index":2,"aggr":"sum"}},"lineChart":{}},"keys":[{"name":"timestamp","index":0,"aggr":"sum"}],"groups":[],"values":[{"name":"mpc_value","index":2,"aggr":"max"},{"name":"mpc_value","index":2,"aggr":"min"},{"name":"mpc_value","index":2,"aggr":"avg"}],"commonSetting":{}},"helium":{}},"1":{"graph":{"mode":"table","height":300,"optionOpen":false}}},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1544216018613_1977400313","id":"20181207-105715_1917558884","dateCreated":"2018-12-07T12:53:38-0800","dateStarted":"2018-12-07T13:26:27-0800","dateFinished":"2018-12-07T13:26:28-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:14380"},{"title":"MPC Value By Timestamp From Two Sites","text":"%sql\n\nselect timestamp,  mpc_value, site from EPAAIRNOW  where site = 840480430101 or site = 840482450102 group by timestamp, mpc_value, site limit 1000\n","user":"admin","dateUpdated":"2018-12-07T13:34:16-0800","config":{"editorSetting":{"language":"sql","editOnDblClick":false},"colWidth":12,"editorMode":"ace/mode/sql","editorHide":true,"title":true,"results":{"0":{"graph":{"mode":"lineChart","height":384,"optionOpen":false,"setting":{"pieChart":{},"scatterChart":{"xAxis":{"name":"timestamp","index":0,"aggr":"sum"},"yAxis":{"name":"value","index":2,"aggr":"sum"}},"lineChart":{}},"keys":[{"name":"timestamp","index":0,"aggr":"sum"}],"groups":[{"name":"site","index":2,"aggr":"sum"}],"values":[{"name":"mpc_value","index":1,"aggr":"max"}],"commonSetting":{}},"helium":{}},"1":{"graph":{"mode":"table","height":300,"optionOpen":false}}},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1544216018615_1978169810","id":"20181207-111925_2029995364","dateCreated":"2018-12-07T12:53:38-0800","dateStarted":"2018-12-07T13:26:31-0800","dateFinished":"2018-12-07T13:26:33-0800","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:14381"},{"text":"%sql\n","dateUpdated":"2018-12-07T12:53:38-0800","config":{"colWidth":12,"editorMode":"ace/mode/sql","results":{},"enabled":true,"editorSetting":{"language":"sql"}},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1544216018620_1974707070","id":"20181102-081010_156471413","dateCreated":"2018-12-07T12:53:38-0800","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:14382"}],"name":"EPA Air Now","id":"2DXVB2A4R","angularObjects":{"2CHS8UYQQ:shared_process":[],"2CKX6DGQZ:shared_process":[],"2C8A4SZ9T_livy2:shared_process":[],"2CK8A9MEG:shared_process":[],"2C4U48MY3_spark2:shared_process":[{"name":"SiteLocations1","object":[{"schema":{"fields":[{"name":"lat","dataType":{"numeric":{},"fractional":{},"asIntegral":{}},"nullable":true,"metadata":{"map":{},"_hashCode":-1609326920,"bitmap$0":true}},{"name":"lon","dataType":{"numeric":{},"fractional":{},"asIntegral":{}},"nullable":true,"metadata":{"map":{},"_hashCode":-1609326920,"bitmap$0":true}},{"name":"site","dataType":{"ordering":{}},"nullable":true,"metadata":{"map":{},"_hashCode":-1609326920,"bitmap$0":true}}],"_hashCode":0,"bitmap$0":0},"values":[32.805818,-97.356568,"840484391002"]},{"schema":{"fields":[{"name":"lat","dataType":{"numeric":{},"fractional":{},"asIntegral":{}},"nullable":true,"metadata":{"map":{},"_hashCode":-1609326920,"bitmap$0":true}},{"name":"lon","dataType":{"numeric":{},"fractional":{},"asIntegral":{}},"nullable":true,"metadata":{"map":{},"_hashCode":-1609326920,"bitmap$0":true}},{"name":"site","dataType":{"ordering":{}},"nullable":true,"metadata":{"map":{},"_hashCode":-1609326920,"bitmap$0":true}}],"_hashCode":0,"bitmap$0":0},"values":[29.770698,-95.031232,"840482010058"]},{"schema":{"fields":[{"name":"lat","dataType":{"numeric":{},"fractional":{},"asIntegral":{}},"nullable":true,"metadata":{"map":{},"_hashCode":-1609326920,"bitmap$0":true}},{"name":"lon","dataType":{"numeric":{},"fractional":{},"asIntegral":{}},"nullable":true,"metadata":{"map":{},"_hashCode":-1609326920,"bitmap$0":true}},{"name":"site","dataType":{"ordering":{}},"nullable":true,"metadata":{"map":{},"_hashCode":-1609326920,"bitmap$0":true}}],"_hashCode":0,"bitmap$0":0},"values":[30.483168,-97.872301,"840484530020"]},{"schema":{"fields":[{"name":"lat","dataType":{"numeric":{},"fractional":{},"asIntegral":{}},"nullable":true,"metadata":{"map":{},"_hashCode":-1609326920,"bitmap$0":true}},{"name":"lon","dataType":{"numeric":{},"fractional":{},"asIntegral":{}},"nullable":true,"metadata":{"map":{},"_hashCode":-1609326920,"bitmap$0":true}},{"name":"site","dataType":{"ordering":{}},"nullable":true,"metadata":{"map":{},"_hashCode":-1609326920,"bitmap$0":true}}],"_hashCode":0,"bitmap$0":0},"values":[26.22621,-98.291069,"840482150043"]},{"schema":{"fields":[{"name":"lat","dataType":{"numeric":{},"fractional":{},"asIntegral":{}},"nullable":true,"metadata":{"map":{},"_hashCode":-1609326920,"bitmap$0":true}},{"name":"lon","dataType":{"numeric":{},"fractional":{},"asIntegral":{}},"nullable":true,"metadata":{"map":{},"_hashCode":-1609326920,"bitmap$0":true}},{"name":"site","dataType":{"ordering":{}},"nullable":true,"metadata":{"map":{},"_hashCode":-1609326920,"bitmap$0":true}}],"_hashCode":0,"bitmap$0":0},"values":[32.922474,-97.282088,"840484392003"]},{"schema":{"fields":[{"name":"lat","dataType":{"numeric":{},"fractional":{},"asIntegral":{}},"nullable":true,"metadata":{"map":{},"_hashCode":-1609326920,"bitmap$0":true}},{"name":"lon","dataType":{"numeric":{},"fractional":{},"asIntegral":{}},"nullable":true,"metadata":{"map":{},"_hashCode":-1609326920,"bitmap$0":true}},{"name":"site","dataType":{"ordering":{}},"nullable":true,"metadata":{"map":{},"_hashCode":-1609326920,"bitmap$0":true}}],"_hashCode":0,"bitmap$0":0},"values":[34.8803,-101.6649,"840483819991"]},{"schema":{"fields":[{"name":"lat","dataType":{"numeric":{},"fractional":{},"asIntegral":{}},"nullable":true,"metadata":{"map":{},"_hashCode":-1609326920,"bitmap$0":true}},{"name":"lon","dataType":{"numeric":{},"fractional":{},"asIntegral":{}},"nullable":true,"metadata":{"map":{},"_hashCode":-1609326920,"bitmap$0":true}},{"name":"site","dataType":{"ordering":{}},"nullable":true,"metadata":{"map":{},"_hashCode":-1609326920,"bitmap$0":true}}],"_hashCode":0,"bitmap$0":0},"values":[29.520443,-95.392509,"840480391004"]},{"schema":{"fields":[{"name":"lat","dataType":{"numeric":{},"fractional":{},"asIntegral":{}},"nullable":true,"metadata":{"map":{},"_hashCode":-1609326920,"bitmap$0":true}},{"name":"lon","dataType":{"numeric":{},"fractional":{},"asIntegral":{}},"nullable":true,"metadata":{"map":{},"_hashCode":-1609326920,"bitmap$0":true}},{"name":"site","dataType":{"ordering":{}},"nullable":true,"metadata":{"map":{},"_hashCode":-1609326920,"bitmap$0":true}}],"_hashCode":0,"bitmap$0":0},"values":[27.76534,-97.434262,"840483550025"]},{"schema":{"fields":[{"name":"lat","dataType":{"numeric":{},"fractional":{},"asIntegral":{}},"nullable":true,"metadata":{"map":{},"_hashCode":-1609326920,"bitmap$0":true}},{"name":"lon","dataType":{"numeric":{},"fractional":{},"asIntegral":{}},"nullable":true,"metadata":{"map":{},"_hashCode":-1609326920,"bitmap$0":true}},{"name":"site","dataType":{"ordering":{}},"nullable":true,"metadata":{"map":{},"_hashCode":-1609326920,"bitmap$0":true}}],"_hashCode":0,"bitmap$0":0},"values":[32.676451,-96.87206,"840481130087"]},{"schema":{"fields":[{"name":"lat","dataType":{"numeric":{},"fractional":{},"asIntegral":{}},"nullable":true,"metadata":{"map":{},"_hashCode":-1609326920,"bitmap$0":true}},{"name":"lon","dataType":{"numeric":{},"fractional":{},"asIntegral":{}},"nullable":true,"metadata":{"map":{},"_hashCode":-1609326920,"bitmap$0":true}},{"name":"site","dataType":{"ordering":{}},"nullable":true,"metadata":{"map":{},"_hashCode":-1609326920,"bitmap$0":true}}],"_hashCode":0,"bitmap$0":0},"values":[31.122419,-97.431052,"840480271045"]},{"schema":{"fields":[{"name":"lat","dataType":{"numeric":{},"fractional":{},"asIntegral":{}},"nullable":true,"metadata":{"map":{},"_hashCode":-1609326920,"bitmap$0":true}},{"name":"lon","dataType":{"numeric":{},"fractional":{},"asIntegral":{}},"nullable":true,"metadata":{"map":{},"_hashCode":-1609326920,"bitmap$0":true}},{"name":"site","dataType":{"ordering":{}},"nullable":true,"metadata":{"map":{},"_hashCode":-1609326920,"bitmap$0":true}}],"_hashCode":0,"bitmap$0":0},"values":[30.039524,-95.673951,"840482010029"]},{"schema":{"fields":[{"name":"lat","dataType":{"numeric":{},"fractional":{},"asIntegral":{}},"nullable":true,"metadata":{"map":{},"_hashCode":-1609326920,"bitmap$0":true}},{"name":"lon","dataType":{"numeric":{},"fractional":{},"asIntegral":{}},"nullable":true,"metadata":{"map":{},"_hashCode":-1609326920,"bitmap$0":true}},{"name":"site","dataType":{"ordering":{}},"nullable":true,"metadata":{"map":{},"_hashCode":-1609326920,"bitmap$0":true}}],"_hashCode":0,"bitmap$0":0},"values":[32.442304,-97.803529,"840482210001"]},{"schema":{"fields":[{"name":"lat","dataType":{"numeric":{},"fractional":{},"asIntegral":{}},"nullable":true,"metadata":{"map":{},"_hashCode":-1609326920,"bitmap$0":true}},{"name":"lon","dataType":{"numeric":{},"fractional":{},"asIntegral":{}},"nullable":true,"metadata":{"map":{},"_hashCode":-1609326920,"bitmap$0":true}},{"name":"site","dataType":{"ordering":{}},"nullable":true,"metadata":{"map":{},"_hashCode":-1609326920,"bitmap$0":true}}],"_hashCode":0,"bitmap$0":0},"values":[32.344008,-95.415752,"840484230007"]},{"schema":{"fields":[{"name":"lat","dataType":{"numeric":{},"fractional":{},"asIntegral":{}},"nullable":true,"metadata":{"map":{},"_hashCode":-1609326920,"bitmap$0":true}},{"name":"lon","dataType":{"numeric":{},"fractional":{},"asIntegral":{}},"nullable":true,"metadata":{"map":{},"_hashCode":-1609326920,"bitmap$0":true}},{"name":"site","dataType":{"ordering":{}},"nullable":true,"metadata":{"map":{},"_hashCode":-1609326920,"bitmap$0":true}}],"_hashCode":0,"bitmap$0":0},"values":[29.723333,-95.635833,"840482010066"]},{"schema":{"fields":[{"name":"lat","dataType":{"numeric":{},"fractional":{},"asIntegral":{}},"nullable":true,"metadata":{"map":{},"_hashCode":-1609326920,"bitmap$0":true}},{"name":"lon","dataType":{"numeric":{},"fractional":{},"asIntegral":{}},"nullable":true,"metadata":{"map":{},"_hashCode":-1609326920,"bitmap$0":true}},{"name":"site","dataType":{"ordering":{}},"nullable":true,"metadata":{"map":{},"_hashCode":-1609326920,"bitmap$0":true}}],"_hashCode":0,"bitmap$0":0},"values":[32.774262,-96.797686,"840481130050"]},{"schema":{"fields":[{"name":"lat","dataType":{"numeric":{},"fractional":{},"asIntegral":{}},"nullable":true,"metadata":{"map":{},"_hashCode":-1609326920,"bitmap$0":true}},{"name":"lon","dataType":{"numeric":{},"fractional":{},"asIntegral":{}},"nullable":true,"metadata":{"map":{},"_hashCode":-1609326920,"bitmap$0":true}},{"name":"site","dataType":{"ordering":{}},"nullable":true,"metadata":{"map":{},"_hashCode":-1609326920,"bitmap$0":true}}],"_hashCode":0,"bitmap$0":0},"values":[26.069615,-97.1622,"840480612004"]},{"schema":{"fields":[{"name":"lat","dataType":{"numeric":{},"fractional":{},"asIntegral":{}},"nullable":true,"metadata":{"map":{},"_hashCode":-1609326920,"bitmap$0":true}},{"name":"lon","dataType":{"numeric":{},"fractional":{},"asIntegral":{}},"nullable":true,"metadata":{"map":{},"_hashCode":-1609326920,"bitmap$0":true}},{"name":"site","dataType":{"ordering":{}},"nullable":true,"metadata":{"map":{},"_hashCode":-1609326920,"bitmap$0":true}}],"_hashCode":0,"bitmap$0":0},"values":[32.668987,-94.167457,"840482030002"]},{"schema":{"fields":[{"name":"lat","dataType":{"numeric":{},"fractional":{},"asIntegral":{}},"nullable":true,"metadata":{"map":{},"_hashCode":-1609326920,"bitmap$0":true}},{"name":"lon","dataType":{"numeric":{},"fractional":{},"asIntegral":{}},"nullable":true,"metadata":{"map":{},"_hashCode":-1609326920,"bitmap$0":true}},{"name":"site","dataType":{"ordering":{}},"nullable":true,"metadata":{"map":{},"_hashCode":-1609326920,"bitmap$0":true}}],"_hashCode":0,"bitmap$0":0},"values":[29.275381,-98.311692,"840480290059"]},{"schema":{"fields":[{"name":"lat","dataType":{"numeric":{},"fractional":{},"asIntegral":{}},"nullable":true,"metadata":{"map":{},"_hashCode":-1609326920,"bitmap$0":true}},{"name":"lon","dataType":{"numeric":{},"fractional":{},"asIntegral":{}},"nullable":true,"metadata":{"map":{},"_hashCode":-1609326920,"bitmap$0":true}},{"name":"site","dataType":{"ordering":{}},"nullable":true,"metadata":{"map":{},"_hashCode":-1609326920,"bitmap$0":true}}],"_hashCode":0,"bitmap$0":0},"values":[33.1324,-96.786419,"840480850005"]},{"schema":{"fields":[{"name":"lat","dataType":{"numeric":{},"fractional":{},"asIntegral":{}},"nullable":true,"metadata":{"map":{},"_hashCode":-1609326920,"bitmap$0":true}},{"name":"lon","dataType":{"numeric":{},"fractional":{},"asIntegral":{}},"nullable":true,"metadata":{"map":{},"_hashCode":-1609326920,"bitmap$0":true}},{"name":"site","dataType":{"ordering":{}},"nullable":true,"metadata":{"map":{},"_hashCode":-1609326920,"bitmap$0":true}}],"_hashCode":0,"bitmap$0":0},"values":[29.583047,-95.015544,"840482011050"]},{"schema":{"fields":[{"name":"lat","dataType":{"numeric":{},"fractional":{},"asIntegral":{}},"nullable":true,"metadata":{"map":{},"_hashCode":-1609326920,"bitmap$0":true}},{"name":"lon","dataType":{"numeric":{},"fractional":{},"asIntegral":{}},"nullable":true,"metadata":{"map":{},"_hashCode":-1609326920,"bitmap$0":true}},{"name":"site","dataType":{"ordering":{}},"nullable":true,"metadata":{"map":{},"_hashCode":-1609326920,"bitmap$0":true}}],"_hashCode":0,"bitmap$0":0},"values":[32.031934,-96.399141,"840483491051"]},{"schema":{"fields":[{"name":"lat","dataType":{"numeric":{},"fractional":{},"asIntegral":{}},"nullable":true,"metadata":{"map":{},"_hashCode":-1609326920,"bitmap$0":true}},{"name":"lon","dataType":{"numeric":{},"fractional":{},"asIntegral":{}},"nullable":true,"metadata":{"map":{},"_hashCode":-1609326920,"bitmap$0":true}},{"name":"site","dataType":{"ordering":{}},"nullable":true,"metadata":{"map":{},"_hashCode":-1609326920,"bitmap$0":true}}],"_hashCode":0,"bitmap$0":0},"values":[31.768291,-106.50126,"840481410037"]},{"schema":{"fields":[{"name":"lat","dataType":{"numeric":{},"fractional":{},"asIntegral":{}},"nullable":true,"metadata":{"map":{},"_hashCode":-1609326920,"bitmap$0":true}},{"name":"lon","dataType":{"numeric":{},"fractional":{},"asIntegral":{}},"nullable":true,"metadata":{"map":{},"_hashCode":-1609326920,"bitmap$0":true}},{"name":"site","dataType":{"ordering":{}},"nullable":true,"metadata":{"map":{},"_hashCode":-1609326920,"bitmap$0":true}}],"_hashCode":0,"bitmap$0":0},"values":[26.288622,-98.152066,"840482151046"]},{"schema":{"fields":[{"name":"lat","dataType":{"numeric":{},"fractional":{},"asIntegral":{}},"nullable":true,"metadata":{"map":{},"_hashCode":-1609326920,"bitmap$0":true}},{"name":"lon","dataType":{"numeric":{},"fractional":{},"asIntegral":{}},"nullable":true,"metadata":{"map":{},"_hashCode":-1609326920,"bitmap$0":true}},{"name":"site","dataType":{"ordering":{}},"nullable":true,"metadata":{"map":{},"_hashCode":-1609326920,"bitmap$0":true}}],"_hashCode":0,"bitmap$0":0},"values":[30.354436,-97.760255,"840484530014"]},{"schema":{"fields":[{"name":"lat","dataType":{"numeric":{},"fractional":{},"asIntegral":{}},"nullable":true,"metadata":{"map":{},"_hashCode":-1609326920,"bitmap$0":true}},{"name":"lon","dataType":{"numeric":{},"fractional":{},"asIntegral":{}},"nullable":true,"metadata":{"map":{},"_hashCode":-1609326920,"bitmap$0":true}},{"name":"site","dataType":{"ordering":{}},"nullable":true,"metadata":{"map":{},"_hashCode":-1609326920,"bitmap$0":true}}],"_hashCode":0,"bitmap$0":0},"values":[30.35386,-97.69166,"840484531068"]},{"schema":{"fields":[{"name":"lat","dataType":{"numeric":{},"fractional":{},"asIntegral":{}},"nullable":true,"metadata":{"map":{},"_hashCode":-1609326920,"bitmap$0":true}},{"name":"lon","dataType":{"numeric":{},"fractional":{},"asIntegral":{}},"nullable":true,"metadata":{"map":{},"_hashCode":-1609326920,"bitmap$0":true}},{"name":"site","dataType":{"ordering":{}},"nullable":true,"metadata":{"map":{},"_hashCode":-1609326920,"bitmap$0":true}}],"_hashCode":0,"bitmap$0":0},"values":[29.043759,-95.472946,"840480391016"]},{"schema":{"fields":[{"name":"lat","dataType":{"numeric":{},"fractional":{},"asIntegral":{}},"nullable":true,"metadata":{"map":{},"_hashCode":-1609326920,"bitmap$0":true}},{"name":"lon","dataType":{"numeric":{},"fractional":{},"asIntegral":{}},"nullable":true,"metadata":{"map":{},"_hashCode":-1609326920,"bitmap$0":true}},{"name":"site","dataType":{"ordering":{}},"nullable":true,"metadata":{"map":{},"_hashCode":-1609326920,"bitmap$0":true}}],"_hashCode":0,"bitmap$0":0},"values":[30.194167,-93.866944,"840483611100"]},{"schema":{"fields":[{"name":"lat","dataType":{"numeric":{},"fractional":{},"asIntegral":{}},"nullable":true,"metadata":{"map":{},"_hashCode":-1609326920,"bitmap$0":true}},{"name":"lon","dataType":{"numeric":{},"fractional":{},"asIntegral":{}},"nullable":true,"metadata":{"map":{},"_hashCode":-1609326920,"bitmap$0":true}},{"name":"site","dataType":{"ordering":{}},"nullable":true,"metadata":{"map":{},"_hashCode":-1609326920,"bitmap$0":true}}],"_hashCode":0,"bitmap$0":0},"values":[28.704607,-100.451156,"840483230004"]},{"schema":{"fields":[{"name":"lat","dataType":{"numeric":{},"fractional":{},"asIntegral":{}},"nullable":true,"metadata":{"map":{},"_hashCode":-1609326920,"bitmap$0":true}},{"name":"lon","dataType":{"numeric":{},"fractional":{},"asIntegral":{}},"nullable":true,"metadata":{"map":{},"_hashCode":-1609326920,"bitmap$0":true}},{"name":"site","dataType":{"ordering":{}},"nullable":true,"metadata":{"map":{},"_hashCode":-1609326920,"bitmap$0":true}}],"_hashCode":0,"bitmap$0":0},"values":[29.863957,-94.317802,"840482450022"]},{"schema":{"fields":[{"name":"lat","dataType":{"numeric":{},"fractional":{},"asIntegral":{}},"nullable":true,"metadata":{"map":{},"_hashCode":-1609326920,"bitmap$0":true}},{"name":"lon","dataType":{"numeric":{},"fractional":{},"asIntegral":{}},"nullable":true,"metadata":{"map":{},"_hashCode":-1609326920,"bitmap$0":true}},{"name":"site","dataType":{"ordering":{}},"nullable":true,"metadata":{"map":{},"_hashCode":-1609326920,"bitmap$0":true}}],"_hashCode":0,"bitmap$0":0},"values":[32.482083,-97.026899,"840481390016"]}],"noteId":"2DXVB2A4R"}],"2CKX8WPU1:shared_process":[],"2CKAY1A8Y:shared_process":[],"2CKEKWY8Z:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}